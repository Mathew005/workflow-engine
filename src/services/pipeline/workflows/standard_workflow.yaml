# This workflow has been updated to the new, more explicit input format.
name: "Standard Dynamic Analysis Workflow"
description: "A declarative workflow demonstrating parallel execution and dependencies using only text input."

# NEW: Explicitly declare the inputs required to start this workflow.
# The UI will dynamically generate widgets based on this section.
inputs:
  - name: "user_message"
    type: "text"
    label: "Enter User Message:"
    default: "The new USB-C port is great, but the battery life seems worse."

steps:
  - name: "initial_analysis"
    type: "llm"
    dependencies: []
    params:
      prompt_template: "1_initial_analysis.txt"
      # The input_mapping now refers to the names declared in the 'inputs' block.
      input_mapping:
        user_message: "user_message"
      output_key: "initial_analysis_result"

  - name: "validate_user_message"
    type: "code"
    dependencies: []
    params:
      function_name: "is_message_long_enough"
      input_key: "user_message"
      output_key: "validation_result"

  - name: "fetch_user_profile"
    type: "code"
    dependencies:
      - "initial_analysis_result"
    params:
      function_name: "get_user_profile_by_intent"
      input_key: "initial_analysis_result"
      output_key: "user_profile"

  - name: "strategist"
    type: "llm"
    dependencies:
      - "initial_analysis_result"
      - "validation_result"
      - "user_profile"
    params:
      prompt_template: "3_strategist.txt"
      input_mapping:
        analysis_result: "initial_analysis_result"
        is_valid: "validation_result"
        profile: "user_profile"
      output_key: "final_strategy"